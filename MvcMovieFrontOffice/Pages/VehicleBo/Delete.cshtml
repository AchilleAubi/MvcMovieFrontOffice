@page
@using MvcMovieFrontOffice.Models
@model MvcMovieFrontOffice.Pages.VehicleBo.Delete

@{
    ViewData["Title"] = "Delete";
    Layout = "_AdminLayout";
}

<h1 class="text-danger text-center">Delete</h1>

<h3 class="text-warning text-center">Are you sure you want to delete this?</h3>
<div class="container mt-4">
    <h4 class="text-primary">Vehicle</h4>
    <hr />
    <dl class="row bg-light p-3 rounded shadow-sm">
        <dt class="col-sm-3 font-weight-bold text-secondary">
            @Html.DisplayNameFor(model => model.Vehicle.Model)
        </dt>
        <dd class="col-sm-9 text-dark">
            @Html.DisplayFor(model => model.Vehicle.Model)
        </dd>
        <dt class="col-sm-3 font-weight-bold text-secondary">
            @Html.DisplayNameFor(model => model.Vehicle.Make)
        </dt>
        <dd class="col-sm-9 text-dark">
            @Html.DisplayFor(model => model.Vehicle.Make)
        </dd>
        <dt class="col-sm-3 font-weight-bold text-secondary">
            @Html.DisplayNameFor(model => model.Vehicle.Year)
        </dt>
        <dd class="col-sm-9 text-dark">
            @Html.DisplayFor(model => model.Vehicle.Year)
        </dd>
        <dt class="col-sm-3 font-weight-bold text-secondary">
            @Html.DisplayNameFor(model => model.Vehicle.Availability)
        </dt>
        <dd class="col-sm-9 text-dark">
            @Html.DisplayFor(model => model.Vehicle.Availability)
        </dd>
        <dt class="col-sm-3 font-weight-bold text-secondary">
            @Html.DisplayNameFor(model => model.Vehicle.Price)
        </dt>
        <dd class="col-sm-9 text-dark">
            @Html.DisplayFor(model => model.Vehicle.Price)
        </dd>
        <dt class="col-sm-3 font-weight-bold text-secondary">
            @Html.DisplayNameFor(model => model.Vehicle.TypeId)
        </dt>
        <dd class="col-sm-9 text-dark">
            @Html.DisplayFor(model => model.Vehicle.TypeId)
        </dd>
        <dt class="col-sm-3 font-weight-bold text-secondary">
            @Html.DisplayNameFor(model => model.Vehicle.Image)
        </dt>
        <dd class="col-sm-9">
            <img src="data:image/jpeg;base64,@Model.Vehicle.Image"
                 alt="Vehicle Image"
                 class="img-fluid border rounded mb-3 shadow-sm"
                 style="max-width: 300px;" />
        </dd>
        <dt class="col-sm-3 font-weight-bold text-secondary">
            @Html.DisplayNameFor(model => model.Vehicle.CreatedAt)
        </dt>
        <dd class="col-sm-9 text-dark">
            @Html.DisplayFor(model => model.Vehicle.CreatedAt)
        </dd>
        <dt class="col-sm-3 font-weight-bold text-secondary">
            @Html.DisplayNameFor(model => model.Vehicle.UpdatedAt)
        </dt>
        <dd class="col-sm-9 text-dark">
            @Html.DisplayFor(model => model.Vehicle.UpdatedAt)
        </dd>
    </dl>

    <div class="mt-4">
        <input type="hidden" value="@Model.Vehicle.Id" />
        <button id="deleteButton" class="btn btn-danger">
            <i class="zmdi zmdi-delete"></i> Delete
        </button>
        <a href="/VehicleBo" class="btn btn-secondary ml-2">
            <i class="fa fa-arrow-left"></i> Back
        </a>
    </div>
</div>

<script>
    document.getElementById("deleteButton").addEventListener("click", async function () {
        const vehicleId = @Model.Vehicle.Id; 

        try {
            const response = await fetch(`http://localhost:5259/api/vehicles/${vehicleId}`, {
                method: "DELETE",
                headers: {
                    "Content-Type": "application/json"
                }
            });

            if (response.ok) {
                console.log("Vehicle deleted successfully");
                window.location.href = '/VehicleBo';
            } else {
                console.error("Error during deletion:", response.status);
            }
        } catch (error) {
            console.error("Network error:", error);
        }
    });
</script>
